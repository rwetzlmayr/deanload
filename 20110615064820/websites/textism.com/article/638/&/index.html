<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
	<title>Textism: Google Hilite</title> 
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<link rel="stylesheet" href="/common/css.css" type="text/css" />
	<link rel="alternate" type="application/rss+xml" title="RSS" href="http://textism.com/?rss=1" />
	<link rel="alternate" type="application/atom+xml" title="Atom" href="http://textism.com/?atom=1" />
</head>
<body>
<div id="container">
<div id="head"><a href="/" onfocus="if(this.blur)this.blur()"><img src="/common/pear2.gif" style="height:142px;width:500px;border:0" alt="Textism" /></a></div>
<div id="left">
		<p>&nbsp;</p>
</div>
<div id="right">
		<p><span class="caps">AUTHOR</span><br />
			<a href="/about/" title="About the author">Dean Allen</a></p>
		<p><span class="caps">OCCUPATION</span><br />
			Industrialist</p>
		<p><span class="caps">LOCATION</span><br />
			Bagnols <sup>s</sup>/C&#232;ze, France</p>
		<p><span class="caps">CONTACT</span><br />
			From <a href="/contact/" title="send a message via this web site">here</a> or <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#100;&#101;&#97;&#110;&#64;&#116;&#101;&#120;&#116;&#105;&#115;&#109;&#46;&#99;&#111;&#109;" title="send a message via your email application">there</a></p>
		<form action="http://textism.com/" method="get"><p>Search<br /><input type="text" name="q" value="" size="15" /></p></form>
		<form action="http://textism.com/" method="get">
<p>Browse<br /><select name="c" onchange="submit(this.form)">
	<option value=""></option>
		<option value="Advertised+Life">Advertised Life</option>
		<option value="Announcements">Announcements</option>
		<option value="Books+%26+Reading">Books & Reading</option>
		<option value="Cupertino">Cupertino</option>
		<option value="Design+is+Business">Design is Business</option>
		<option value="Dull+White+Men">Dull White Men</option>
		<option value="Elsewhere">Elsewhere</option>
		<option value="Food">Food</option>
		<option value="France">France</option>
		<option value="Gardening">Gardening</option>
		<option value="Google">Google</option>
		<option value="Hacks">Hacks</option>
		<option value="Herself">Herself</option>
		<option value="How+To">How To</option>
		<option value="Irritation">Irritation</option>
		<option value="Laffs">Laffs</option>
		<option value="Memoir">Memoir</option>
		<option value="Microsoft">Microsoft</option>
		<option value="Movies">Movies</option>
		<option value="Music">Music</option>
		<option value="Oliver">Oliver</option>
		<option value="Other+People">Other People</option>
		<option value="Photographs">Photographs</option>
		<option value="Published+Web">Published Web</option>
		<option value="Questions">Questions</option>
		<option value="Rock+Gods">Rock Gods</option>
		<option value="Scripting">Scripting</option>
		<option value="Shopping">Shopping</option>
		<option value="Stories">Stories</option>
		<option value="Teaching">Teaching</option>
		<option value="Text+Wrangling">Text Wrangling</option>
		<option value="The+Move">The Move</option>
		<option value="Typography">Typography</option>
		<option value="Verisign">Verisign</option>
		<option value="Web+Economy">Web Economy</option>
</select></p><noscript><input type="submit" value="go" /></noscript></form>
</div>
<div id="center">
	<h3><a href="http://textism.com/article/638/google-hilite" title="Permanent link to this article">Google Hilite</a> &#183; 30 November 2002</h3>
	<p>I saw that young <a href="http://q.queso.com/" title="Q Daily News">Dr Levine</a> (the hardest working human in modern pediatrics) had implemented a very suave bit of scripting, one that highlights the search terms that bring people to his site via Google.</p>

	<p>I was like <span class="caps">WHOAH DOOD</span> and he was all <span class="caps">LAHLAH LOOK AT ME</span> and I was all <span class="caps">NOT EVEN</span> and he was all <span class="caps">LOOKIT MY GOOGLE THING</span> and I&#8217;m like <span class="caps">NO WAY DOOD</span> and he&#8217;s like <span class="caps">NYAH NYAH</span> and I&#8217;m like</p>

<p><code>
&#60;?php<br />
function google_hilite($text) {<br />
$ref = urldecode($_SERVER[HTTP_REFERER]);<br />
if (preg_match('/^http:\/\/w?w?w?\.?google.*/i',$ref)) {<br />
$query = preg_replace('/^.*q=([^&#38;]+)&#38;?.*$/i','$1',$ref);<br />
$query = preg_replace('/\'|"/','',$query);<br />
$query_array = preg_split ("/[\s,\+\.]+/",$query);<br />
foreach($query_array as $b){<br />
if (!preg_match('/&#60;.+&#62;/',$text)) {<br />
$text = preg_replace(<br />
'/(\b'.$b.'\b)/i',<br />
'&#60;span class="hilite"&#62;$1&#60;/span&#62;',<br />
$text);  <br />
} else {<br />
$text = preg_replace(<br />
'/(?&#60;=&#62;)([^&#60;]+)?(\b'.$b.'\b)/i',<br />
'$1&#60;span class="hilite"&#62;$2&#60;/span&#62;',<br />
$text);<br />
}<br />
}<br />
}<br />
return $text;<br />
}<br />
?&#62;
</code></p>

	<p>Some documentation and an ancillary script are <a href="http://textism.com/tools/google_hilite/google_hilite.txt" title="source">here</a>.</p>

	<p>To see Google Hilite in action, click through the first result on a Google search for <a href="http://www.google.com/search?client=googlet&#38;q=fuck%20me" title="Google Search: fuck me">fuck me</a> (after the &#8216;sponsored link&#8217;) or the fifth (!) result for <a href="http://www.google.com/search?hl=en&#38;lr=&#38;ie=ISO-8859-1&#38;client=googlet&#38;q=verisign" title="Google Search: verisign">Verisign</a>.</p>

<p>NB: The examples cited above weren&#8217;t working for a few hours on Sunday, owing to a cockup by the author.</p>

	<p><span class="caps">UPDATE</span>: Using this is much simpler than I may have indicated. Google Hilite can be used on just about any page, so long as PHP is running on the server. <a href="/tools/google_hilite/">Further details and a download</a>.</p>


<p style="text-align:center">* &nbsp; * &nbsp; *</p>

<p class="nav"><a href="http://textism.com/article/637/at-321-pm">&#8592; At 3:21 PM | </a>
<a href="http://textism.com/">Home</a>
<a href="http://textism.com/article/640/not-that-kind"> | Not That Kind &#8594;</a>
</p>
</div>
<div id="foot">&nbsp;</div>
</div>
</body>
</html>